<!DOCTYPE html>
<html class="fuelux" lang="en" charset="utf-8">
  <head>
    <meta charset="utf-8">

    <title>Non intrusive desktop automation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Screen scraping and UI automation software for desktop and web apps, Workflow to code in 1 click, 100% accuracy, extremely fast, excellent UI recognition">
	<meta name="keywords" content="UiPath Studio, ui automation, screen scraping, web scraping, data scraping, text capture, workflow automation, web automation, report mining">
	
	<!-- Le styles -->
	<link href="http://fuelcdn.com/fuelux/2.2/css/fuelux.css" rel="stylesheet" />
	<link href="http://fuelcdn.com/fuelux/2.2/css/fuelux-responsive.css" rel="stylesheet" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
	<script src="http://fuelcdn.com/fuelux/2.2/loader.min.js" type="text/javascript"></script> 
    <link href="/css/docs.css" rel="stylesheet">
	<link href="/js/google-code-prettify/prettify.css" rel="stylesheet">	
	
	<link href="/css/syntax.css" rel="stylesheet">
	<link href="/css/style-v.4.css" rel="stylesheet">
	<link href="/css/fonts.css" rel="stylesheet">
	
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/favicon.ico">    
  </head>
<body id="body" data-spy="scroll" data-target=".subnav" data-offset="50" style="background: none #f5f5f5;">
<div id="container" class="">
    <div id="header-container">
        <div id="header">
			<a href="/" class="link_logo" id="logo-link" alt="logo"><img src="/img/logo_small.png" class="logo_holder" alt=""><span id="header-logo-text">uipath</span></a>
			<span class="header_small_motto" id="header-motto">Understands User Interface</span>
			<div class="navigation">
				<ul>
					<li><a href="http://www.uipath.com/" title="Product Site">Product Site</a></li>
					<li><a href="https://github.com/Deskover/UiPath/wiki" title="Documentation Wiki">Documentation Wiki</a></li>
				</ul>
			</div>       
		</div>
    </div>
</div>


<div class="home_content">
	<h1 style="text-align: center;">Non intrusive desktop automation</h2>
	<div class="tab_description">	  		
		<div style="margin: 20px;">
			<h2>Overview</h2>

<p>This blog post is about desktop automation in <a href="%5Bhttp://www.uipath.com/">UiPath</a> and more specifically about non intrusive GUI automation. 
We&#39;ll talk about methods to simulate keyboard and mouse events available in UiPath. We&#39;ll get into more details about their internals and use case scenarios.</p>

<h2>Problem</h2>

<p>GUI automation can be the solution when dealing with legacy software systems that were designed to be used only by humans with no API support for data automation and interoperability.
Data is automatically extracted and input directly into the controls on the screen. Anything you see on the screen from SAP and Oracle to .Net and Adobe apps can be controlled and automated by UiPath.
Another hot area for GUI automation is automated GUI testing. </p>

<p>Some GUI automation scenarios have special requirments regarding how the automation scripts interfere with the user that is currently logged on.
<em>Non intrusive GUI automation</em> requires that automation scripts should not remove or hide users&#39; access to existing applications.</p>

<p>Automation code should not change the focus, the active window, take away the mouse or keyboard, logout from the current windows session or restrict the user&#39;s control in any way.
Non invasive GUI automation should remain unnoticed by the users while it performs automation tasks in background.</p>

<h2>How to</h2>

<p>The straightforward way to automate the GUI is to call operating systems API to generate hardware mouse / keyboard events. <em>Win32 API</em> provides useful functions like: 
<a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646304(v=vs.85).aspx">keybd_event</a>, <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646260(v=vs.85).aspx">mouse_event</a> and <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx">SendInput</a>.
The problem with this approach is that it interferes with user actions. The mouse and keyboard control is taken away from the user, the window to be automated must be placed in foreground and the focused control has to be changed.</p>

<p>For non-intrusive autoamtion, <em>UiPath</em> makes use of Win32 windows messages, <a href="http://en.wikipedia.org/wiki/Microsoft_Active_Accessibility">Active Accessibility</a>, <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/access/jab/index.html">Java Accessibility API</a>, <a href="http://en.wikipedia.org/wiki/Document_Object_Model">HTML DOM</a> and <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ee684009(v=vs.85).aspx">UI Automation API</a>.</p>

<p><a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-UiInputMethod">UiInputMethod</a> enumeration specifies the automation technology used by <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Click">Click</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Hover">Hover</a> and <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-WriteText">WriteText</a>.</p>

<ul>
<li>UI_HARDWARE_EVENTS - keystrokes and mouse events are synthesized by <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310(v=vs.85).aspx">SendInput</a> Win32 API function.</li>
<li>UI_WIN32_MSG - WM_LBUTTONDOWN, WM_LBUTTONUP and WM_CHAR windows messages are posted to target UI control.</li>
<li>UI_CONTROL_API - the underlying technology of the UI object is used to generate events (like Active Accessibility, Java Accessibility Bridge, HTML events)</li>
</ul>

<p>There is also support in <em>UiPath library</em> for launching a hidden <em>Internet Explorer</em> browser (see <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-UiBrowserType">UiBrowserType</a>) which may prove very useful when performing background web automation.</p>

<p>Which method to use really depends on the target application you want to automate. Sometimes <em>Active Accessibility</em> is poorly implemented by target apps, for some scenarios <em>UI_WIN32_MSG</em> works best, for automation HTML <em>UI_CONTROL_API</em> is the way to go.
You have to play a little bit with all the methods to see which works best in your particular case (you can do that with <a href="https://github.com/Deskover/UiPath/wiki/Studio">UiStudio</a> and <a href="https://github.com/Deskover/UiPath/wiki/Workflow-designer">UiWorkflow</a> tools). </p>

<p>Another case when you would want non intrusive automation is when using UiPath monitoring events (see: <a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor">UiNodeMonitor</a> and <a href="https://github.com/Deskover/UiPath/wiki/UiEventInfo">UiEventInfo</a>).
This is one cool feature that lets you easilly intercept user actions on UI elements. When an event that you are interested in is caught you almost always want to perform some non intrusive automation.
It is a really interesting scenario and we&#39;ll dedicate it a full blog post very soon.</p>

<h2>Conclusions</h2>

<p>You would want non intrusive GUI automation when you</p>

<ul>
<li>deal with UiPath events</li>
<li>want to run multiple test scripts without interference</li>
<li>integrate apps without disturbing the user</li>
<li>perform background automation</li>
<li>automate apps logging in other windows account + disconnected remote desktops</li>
<li>automate hidden windows/browsers (cannot click hidden controls)</li>
</ul>

<p>See you later,</p>

<p>Adrian.</p>
 					
		</div>			
	</div>			
</div>		

<footer class="footer">
  <div class="container">
	<p class="pull-right">  |  <a href="#">Back to top</a>  |   </p>        
	<p>Page last generated on September 19, 2013</p>
  </div>
</footer>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>    
   	<script src="/js/custom.js" type="text/javascript"></script>	

	<script type="text/javascript">
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		var disqus_shortname = 'screenscraper'; // required: replace example with your forum shortname

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var s = document.createElement('script'); s.async = true;
			s.type = 'text/javascript';
			s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
			(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
		}());
	</script>
	
	<!-- Google Analytics -->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-65056-8']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
  </body>
</html>
