<!DOCTYPE html>
<html class="fuelux" lang="en" charset="utf-8">
  <head>
    <meta charset="utf-8">

    <title>UiPath UiAutomation API walk-through</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Screen scraping and UI automation software for desktop and web apps, Workflow to code in 1 click, 100% accuracy, extremely fast, excellent UI recognition">
	<meta name="keywords" content="UiPath Studio, ui automation, screen scraping, web scraping, data scraping, text capture, workflow automation, web automation, report mining">
	
	<!-- Le styles -->
	<link href="http://fuelcdn.com/fuelux/2.2/css/fuelux.css" rel="stylesheet" />
	<link href="http://fuelcdn.com/fuelux/2.2/css/fuelux-responsive.css" rel="stylesheet" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
	<script src="http://fuelcdn.com/fuelux/2.2/loader.min.js" type="text/javascript"></script> 
    <link href="/css/docs.css" rel="stylesheet">
	<link href="/js/google-code-prettify/prettify.css" rel="stylesheet">	
	
	<link href="/css/syntax.css" rel="stylesheet">
	<link href="/css/style-v.4.css" rel="stylesheet">
	<link href="/css/fonts.css" rel="stylesheet">
	
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/favicon.ico">    
  </head>
<body id="body" data-spy="scroll" data-target=".subnav" data-offset="50" style="background: none #f5f5f5;">
<div id="container" class="">
    <div id="header-container">
        <div id="header">
			<a href="/" class="link_logo" id="logo-link" alt="logo"><img src="/img/logo_small.png" class="logo_holder" alt=""><span id="header-logo-text">uipath</span></a>
			<span class="header_small_motto" id="header-motto">Understands User Interface</span>
			<div class="navigation">
				<ul>
					<li><a href="http://www.uipath.com/" title="Product Site">Product Site</a></li>
					<li><a href="https://github.com/Deskover/UiPath/wiki" title="Documentation Wiki">Documentation Wiki</a></li>
				</ul>
			</div>       
		</div>
    </div>
</div>


<div class="home_content">
	<h1 style="text-align: center;">UiPath UiAutomation API walk-through</h2>
	<div class="tab_description">	  		
		<div style="margin: 20px;">
			<h2>Overview</h2>

<p>If you are reading this then you are most likely interested in GUI automation and/or screens scraping. This article presents UiPath GUI automation library. You will learn about what it can do, its main features and core API components.</p>

<h2>What is?</h2>

<p>UiPath is a complete solution for software automation with an accent on GUI automation. The <a href="https://github.com/Deskover/UiPath/wiki/Workflow-designer">workflow designer</a> along with the GUI action recorder and GUI automation wizards make the user interface of other applications accessible with no programming effort.</p>

<p>For the diehard programmer that needs maximum flexibility, beneath workflow activities there is a powerful <em>COM</em> library that can be used from virtually any programming language / IDE dubbed UiPath UiAutomation API (blame my manager for the name) . This API makes the GUI of other applications programmable, exposing the attributes of GUI objects on the screen and also simulating user actions on them. For those in a hurry here is the <a href="https://github.com/Deskover/UiPath/wiki/UI-Automation-API-reference">UiPath UiAutomation API reference</a>.</p>

<h2>UiPath at a glance</h2>

<p>A code sample is worth a thousand words so here is the “hello world” GUI automation code:</p>
<div class="highlight"><pre><code class="javascript language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">UI_WIN32_MSG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// Instantiate UiSystem library object and launch notepad.exe</span>
<span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">WScript</span><span class="p">.</span><span class="nx">CreateObject</span><span class="p">(</span><span class="s2">&quot;UiPath.UiSystem&quot;</span><span class="p">);</span>
<span class="nx">s</span><span class="p">.</span><span class="nx">RunApplication</span><span class="p">(</span><span class="s2">&quot;notepad.exe&quot;</span><span class="p">);</span>

<span class="c1">// Instantiate UiNode library object.</span>
<span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">WScript</span><span class="p">.</span><span class="nx">CreateObject</span><span class="p">(</span><span class="s2">&quot;UiPath.UiNode&quot;</span><span class="p">);</span>

<span class="c1">// Search for the editable control inside notepad application.</span>
<span class="nx">n</span><span class="p">.</span><span class="nx">FromSelector</span><span class="p">(</span><span class="s2">&quot;&lt;wnd app=&#39;notepad.exe&#39; cls=&#39;Notepad&#39; title=&#39;Untitled - Notepad&#39;/&gt;&lt;wnd cls=&#39;Edit&#39;/&gt;&lt;ctrl role=&#39;editable text&#39;/&gt;&quot;</span><span class="p">);</span>

<span class="c1">// Write some text into the edit control.</span>
<span class="nx">n</span><span class="p">.</span><span class="nx">WriteText</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span> <span class="nx">UI_WIN32_MSG</span><span class="p">);</span>
</code></pre></div>
<p>This is <a href="http://en.wikipedia.org/wiki/JScript">JScript</a> sample that you can run with wscript.exe or cscript.exe. It feels a little bit too long for a “hello world” sample because of the comments and constant definitions required by good programming practices which double the line count.
As you can see it starts with instantiating a library system object, launches notepad.exe application and fills out “hello world” text into the editable area.
UiPath can perform this magic because it understands the internals of various UI frameworks: <em>Win32</em>, <em>WPF</em>, <em>HTML</em>, <em>PDF</em>, <em>Java</em>. The UI objects are usually arranged in a hierarchically tree, the root being the top level window the app and the UI controls being the leaves.</p>

<h2>UiNode</h2>

<p>The most important object of the library is <a href="https://github.com/Deskover/UiPath/wiki/Uinode">UiNode</a> which represents an object in the UI hierarchy and it can do a lot of things:</p>

<ul>
<li>find UI objects on the screen: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromSelector">FromSelector</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromScreenPoint">FromScreenPoint</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromScreenRegion">FromScreenRegion</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromDesktop">FromDesktop</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromWindow">FromWindow</a></li>
<li>navigate through the UI tree: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Child">Child</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FindFirst">FindFirst</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FindAll">FindAll</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Parent">Parent</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-TopParent">TopParent</a></li>
<li>simulate user actions: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Click">Click</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Hover">Hover</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-WriteText">WriteText</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-SetFocus">SetFocus</a></li>
<li>scrape the text or image of UI objects: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Scrape">Scrape</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Screenshot">Screenshot</a></li>
<li>get/set attributes of the UI objects: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Get">Get</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-Set">Set</a></li>
<li>inject scripts into web pages and extract HTMl data: <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-InjectAndRunJS">InjectAndRunJS</a>, <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-ExtractData">ExtractData</a></li>
</ul>

<h2>Selector</h2>

<p>The most important method of UiNode is <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FromSelector">FromSelector</a> which searches for a GUI object on the screen based on a XML-like string called selector. The selector contains all the necessary information to identify an GUI object at runtime. Here is the selector that identifies the editable area in notepad.exe app.</p>
<div class="highlight"><pre><code class="xml language-xml" data-lang="xml"><span class="nt">&lt;wnd</span> <span class="na">app=</span><span class="s">&#39;notepad.exe&#39;</span> <span class="na">cls=</span><span class="s">&#39;Notepad&#39;</span> <span class="na">title=</span><span class="s">&#39;Untitled - Notepad&#39;</span><span class="nt">/&gt;&lt;wnd</span> <span class="na">cls=</span><span class="s">&#39;Edit&#39;</span><span class="nt">/&gt;&lt;ctrl</span> <span class="na">role=</span><span class="s">&#39;editable text&#39;</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>As you can see, the selector describes a path from the top level window to the GUI object we’re looking for. Each XML part defines an object by specifying its relevant attributes. The selector is important because it provides a way of identifying the GUI objects based on their attributes rather than their size and position on the screen.
Selectors may seem complicated but worry not, UiPath has tools that generate them automatically. <a href="https://github.com/Deskover/UiPath/wiki/Selector">Here</a> you may find the full selector story.</p>

<h2>Image-based GUI automation</h2>

<p>As we have seen, the selector is the best method of object recognition (when it works). There are applications like remote desktop clients which only paint the controls on the screen. For these apps the selector can only identify the top level window of the application but not the controls inside.
For these special scenarios UiPath provides image-based GUI automation and <em>OCR</em> screen scraping. The idea behind image-based GUI automation is to use screenshot patterns to identify controls and GUI components and then direct mouse and keyboard events to them. First you take a screenshot of the control you want to automate and them the library searches for the image to get the position of the control on the screen.</p>

<p>Here’s the pseudo-code of image-based GUI automation:</p>

<ul>
<li>instantiate a <a href="https://github.com/Deskover/UiPath/wiki/UiImage">UiImage</a> object and call <a href="https://github.com/Deskover/UiPath/wiki/UiImage#wiki-LoadFile">LoadFile</a> against the file containing the image of the GUI object</li>
<li>instantiate a UiNode and use FromSelector to find the top level window of the app to be automated</li>
<li>call <a href="https://github.com/Deskover/UiPath/wiki/Uinode#wiki-FindImage">uiNode.FindImage</a> against the image object at step one and get a <a href="https://github.com/Deskover/UiPath/wiki/UiRegion">UiRegion</a> which represents the coordinates of the UI object on the screen</li>
<li>having the coordinates we can Click on the GUI object</li>
</ul>

<h2>Other library objects</h2>

<p>There are several other objects in the library that completes the feature list.</p>

<ul>
<li><a href="https://github.com/Deskover/UiPath/wiki/UiBrowser">UiBrowser</a> which provides browser-related functionality like: <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-Start">Start</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-Navigate">Navigate</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-Refresh">Refresh</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-Close">Close</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiBrowser#wiki-WaitPage">WaitPage</a></li>
<li><a href="https://github.com/Deskover/UiPath/wiki/UiWindow">UiWindow</a> exposes window-related methods like: Move, Maximize, Minimize, Restore, Close, Show, Hide</li>
<li><a href="https://github.com/Deskover/UiPath/wiki/UiSystem">UiSystem</a> provides system-related features like: <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-GetClipboardText">GetClipboardText</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-SetClipboardText">SetClipboardText</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-RunApplication">RunApplication</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-CloseApp">CloseApp</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-Cleanup">Cleanup</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-GetActiveWindow">GetActiveWindow</a></li>
</ul>

<h2>Event triggers</h2>

<p>Event trigger is UiPath’s unique feature. In a way, it is the opposite of GUI automation. While GUI automation simulates user actions by generating click and keyboard events on GUI controls, events triggers intercepts user actions on certain controls.</p>

<p>It works like this:</p>

<ul>
<li>you first specify what event you are interested in: mouse or keyboard and which mouse button / key combination</li>
<li>you specify a selector to specify what GUI objects to monitor</li>
<li>specify a screen region to restricts the area inside the matching visual elements in which the clicks will be monitored</li>
</ul>

<p>When the event occurs and all the conditions are satisfied your code will be notified (a <em>COM</em> callback function will be called). The client code has the option to cancel the event so it won’t get to the target GUI control.</p>

<p>Here are the event-related library objects and methods:</p>

<ul>
<li><a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor">UiNodeMonitor</a>: <a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor#wiki-MonitorClick">MonitorClick</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor#wiki-MonitorClickOnImage">MonitorClickOnImage</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor#wiki-MonitorHotkey">MonitorHotkey</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiNodeMonitor#wiki-StopMonitor">StopMonitor</a></li>
<li><a href="https://github.com/Deskover/UiPath/wiki/UiSystem">UiSystem</a>: <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-MonitorClick">MonitorClick</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-MonitorHover">MonitorHover</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-MonitorHotkey">MonitoryHotkey</a>, <a href="https://github.com/Deskover/UiPath/wiki/UiSystem#wiki-StopMonitoring">StopMonitoring</a>. UiSystem provides global monitoring (not restricted to any GUI object)</li>
</ul>

<p><a href="https://github.com/Deskover/UiPath/wiki/Api-documentation#wiki-UI_events">Here</a> is the full story on UI event triggers.</p>

<h2>Conclusions</h2>

<p>By now, you should have a fairly good idea about what UiPath GUI automation library is, what it can do and its core concepts.</p>

<p>Keep in mind that UiPath product is more than only a GUI automation library. It’s a software automation and application integration tool that automates business processes. With its powerful workflow designer one can easily:</p>

<ul>
<li>automatically send emails and sms</li>
<li>process XML, CSV, Excel files</li>
<li>invoke Powershell scripts</li>
<li>make HTTP and SOAP calls</li>
<li>perform database transactions</li>
<li>...and much more.</li>
</ul>

<p>Until next time,</p>

<p>Adrian.</p>
 					
		</div>			
	</div>			
</div>		

<footer class="footer">
  <div class="container">
	<p class="pull-right">  |  <a href="#">Back to top</a>  |   </p>        
	<p>Page last generated on September 19, 2013</p>
  </div>
</footer>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>    
   	<script src="/js/custom.js" type="text/javascript"></script>	

	<script type="text/javascript">
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		var disqus_shortname = 'screenscraper'; // required: replace example with your forum shortname

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var s = document.createElement('script'); s.async = true;
			s.type = 'text/javascript';
			s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
			(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
		}());
	</script>
	
	<!-- Google Analytics -->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-65056-8']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>
  </body>
</html>
